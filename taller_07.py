# -*- coding: utf-8 -*-
"""Taller_07.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1rFpPc3L56diWvD4qTj8g7w19xeMsDJH0

<h1 align="center">
Taller 07 - Operaciones con Listas
</h1>
"""

# Preparaci贸n de los datos para los ejercicios
import pandas as pd

url = 'https://raw.githubusercontent.com/BrayanTorres2/POO_2022_C1/main/municipios.csv'
df = pd.read_csv(url)
municipios = []

for (_, m) in df.iterrows():
    mun = (m[0], m[1], m[2], m[3], m[4], False if m[5] == 0 else True)
    municipios.append(mun)
print('Cantidad de municipios', len(municipios))

"""## La informaci贸n de los municipios

Tenemos la informaci贸n de todos los municipios de colombia en una lista de tuplas con la siguiente conformaci贸n:

* El primer elemento es el c贸digo del municipio, un n煤mero
* El segundo elemento es el nombre del municipio
* El tercer elemento es la poblaci贸n urbana del municipio
* El cuarto elemento es la poblaci贸n rural del municipio
* El quinto elemento es el nombre del departamento donde esta el municipio
* El sexto elemento es **True** si el municipio es la capital del departamento y **False** si no se trata de la capital del departamento.

---

## Ejercicio 01

Escriba una funci贸n que reciba la lista de municipios como dato de entrada, as铆 como el nombre de un departamento y que retorne cu谩ntos municipios de la lista pertenecen a ese departamento.
"""

def ejercicio01(muns: [(int, str, int, int, str, bool)], nomdepto: str) -> int:
    c = 0
    for i,m,u,r,d,x in muns:
        if d==nomdepto:
            c+=1
    return c

# ----------------------------------------------------------------------------
# Pruebas
assert ejercicio01(municipios, 'Amazonas') == 11
assert ejercicio01(municipios, 'Boyac谩') == 123
print('Prueba superada ')

"""## Ejercicio 02

Dada una lista con los municipio de Colombia, retorne una lista con los nombres de los municipios que no tienen poblaci贸n urbana.
"""

def ejercicio02(municipios: [(int, str, int, int, str, bool)]) -> [str]:
    resultado = []
    for(codigo,nombre,poburb,pobrur,dept,cap) in municipios:
        if poburb==0:
            resultado.append(nombre)
    return resultado

# Prueba del ejercicio 02
noms = ejercicio02(municipios)
noms.sort()
assert noms == ['Barranco Minas', 'Cacahual', 'El Encanto', 'La Chorrera', 'La Guadalupe', 'La Pedrera', 'La Victoria', 'Mapiripana', 'Mirit铆-Paran谩', 'Morichal Nuevo', 'Pacoa', 'Pana Pana', 'Papunaua', 'Puerto Alegr铆a', 'Puerto Arica', 'Puerto Colombia', 'Puerto Santander', 'San Felipe', 'Tarapac谩', 'Yavarat茅']
print("Prueba superada ")

"""## Ejercicio 03

Escriba una funci贸n en Python que reciba la lista con la informaci贸n de todos los municipios de Colombia, y el nombre de un departamento, y que retorne la suma de la poblaci贸n urbana de todos los municipios de ese departamento, as铆 como la cantidad de municipios que pertenecen a ese departamento tambi茅n.
"""

def ejercicio03(municipios: [(int, str, int, int, str, bool)], dpto: str) -> (int, int):
    suma = 0
    cont = 0
    for(codigo,nombremun,poburb,pobrur,dept,cap) in municipios:
        if dpto==dept:
            cont=cont+1
            suma=(poburb+suma)
    return (suma, cont)

# Prueba de la funci贸n 03
assert ejercicio03(municipios, "La Guajira") == (552_638, 15)
assert ejercicio03(municipios, "Huila") == (703_936, 37)
assert ejercicio03(municipios, "Atl谩ntico") == (2_408_093, 23)
assert ejercicio03(municipios, "Antioquia") == (5_181_668, 125)
print("Prueba superada ")

"""## Ejercicio 04

Escriba una funci贸n que reciba la lista con la informaci贸n de todos los municipios del pa铆s y el c贸digo de un municipio y que retorne el nombre y el departamento del municipio que tiene ese c贸digo. Si no existe ese c贸digo, deber谩 retornar el mensaje "no existe".
"""

def ejercicio04(municipios: [(int, str, int, int, str, bool)], codigo: int) -> (str, str):
    for(cod,nombremun,poburb,pobrur,dept,cap) in municipios:
        if cod==codigo:
            a=(nombremun,dept)
        elif codigo>1222:
            a="no existe"
    return (a)

# Prueba de la funci贸n ejercicio 04
assert (ejercicio04(municipios, 438)) == ('Caloto', 'Cauca')
assert (ejercicio04(municipios, 7)) == ('Soledad', 'Atl谩ntico')
assert (ejercicio04(municipios, 1024)) == ('Alejandr铆a', 'Antioquia')
assert (ejercicio04(municipios, 819)) == ('Barichara', 'Santander')
assert (ejercicio04(municipios, 1819)) == 'no existe'
print("Prueba superada ")

"""## Ejercicio 05

Escriba una funci贸n en Python que reciba una lista con la informaci贸n de todos los municipios de Colombia y que halle el porcentaje de municipios de la lista que son capitales y cuya poblaci贸n urbana supera el mill贸n de habitantes.
"""

import math

def ejercicio05(municipios: [(int, str, int, int, str, bool)]) -> float:
    listamun=[]
    for(cod,nombremun,poburb,pobrur,dept,cap) in municipios:
        if cap==True:
            if poburb>1_000_000:
                listamun.append(poburb)
    a=((len(listamun))*100/len(municipios))
    return(a)            

# Prueba de la funci贸n del ejercicio 5
assert math.isclose(ejercicio05(municipios), 0.3565, rel_tol=1e-4)
print("Prueba superada ")

"""## Ejercicio 06

Escriba una funci贸n que reciba la lista con la informaci贸n de todos los municipios de Colombia y el nombre de un departamento, y que retorne el nombre del municipio de ese departamento que tiene la poblaci贸n urbana m谩s peque帽a.
"""

def ejercicio06(municipios: [(int, str, int, int, str, bool)], dpto: str) -> str:
    max=2**32
    nombre=""
    for(cod,nombremun,poburb,pobrur,dept,cap) in municipios:
        if dpto==dept:
            if(max>poburb):
                max=poburb
                nombre=nombremun
    return(nombre)  

# Prueba de la funci贸n del ejercicio 06
assert (ejercicio06(municipios, 'Santander'))  == 'Jord谩n'
assert (ejercicio06(municipios, 'Boyac谩')) == 'Ch铆quiza'
assert (ejercicio06(municipios, 'Magdalena')) == 'San Zen贸n'
assert (ejercicio06(municipios, 'Cundinamarca')) == 'F煤quene'
print("Prueba superada ")

"""## Ejercicio 07

Escriba una funci贸n en Python que reciba una lista con la informaci贸n de todos los municipios de Colombia y dos c贸digos, y que retorne la suma de la poblaci贸n rural de aquellos municipios cuyo c贸digo sea mayor o igual que el primer c贸digo y menor o igual que el segundo c贸digo.
"""

def ejercicio07(municipios: [(int, str, int, int, str, bool)], cod1: int, cod2: int) -> int:
    suma = 0
    for(cod,nombremun,poburb,pobrur,dept,cap) in municipios:
        if cod>=cod1 and cod<=cod2:
            suma=pobrur+suma
    return suma

# Prueba de la funci贸n del ejercicio 07
assert (ejercicio07(municipios, 850, 960)) == 416_362
assert (ejercicio07(municipios, 1, 10)) == 193_550
assert (ejercicio07(municipios, 300, 400)) == 1_217_094
print("Prueba superada ")